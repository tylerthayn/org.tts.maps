let _ = require('org.tts.js.lodash')
let Kml = require('./Kml')
//let Overpass = require('./Overpass')
let Query = require('query-overpass')
let Turf = require('@turf/turf')
let basePath = 'D:/GITHUB/Maps/kml/'

Kml.Use('./plugins/Styler')

let q = `
[out:json];
nwr(poly:"37.94203788888126 -110.9915058711863 37.89731340040456 -110.99145281816104 37.86115040647173 -110.95811246182693 37.84734205497252 -110.90423593579104 37.86115040647173 -110.85035940975514 37.89280757708334 -110.8211731827884 37.88517790583933 -110.79138889616634 37.89898624060259 -110.73748468624575 37.935149207413 -110.70412713992316 37.97987369583627 -110.70407398724126 38.01607652059771 -110.73739868322981 38.01659439182312 -110.73941993976382 38.05116849946352 -110.70747733176471 38.09589298772223 -110.707423872244 38.11790231341809 -110.72771546007179 38.1448602695544 -110.72768315861843 38.16822950276308 -110.74924292073638 38.184310003298485 -110.7492236150571 38.22051297509456 -110.78264141825224 38.23434603449817 -110.83678299316591 38.22051297509456 -110.89092456807958 38.184310003298485 -110.9243423712747 38.139585515166026 -110.92428867663871 38.11621732828863 -110.90267285810347 38.100135781365516 -110.90265358893726 38.07813030572344 -110.88230932588209 38.05116849946352 -110.88227709823018 38.01500561599563 -110.84886663908695 38.014487698879236 -110.84684161931018 37.984449005945024 -110.87449223266766 37.99207363811631 -110.90423593579104 37.978240686520266 -110.95819830359444 37.94203788888126 -110.9915058711863") -> .all;
(
	node.all[natural];
);
(._;>;);
out;
`
Query(q, (error, data) => {
	if (error) throw error
	let kml = new Kml(data)
	kml.Save('D:/GITHUB/Maps/kml/Placemarks.kml')
})

//let kml = new Kml(Overpass('way/630174617'))
//

//let kml = new Kml('D:/GITHUB/Maps/kml/North Regio2n.kml')
//log(kml.Tree['North Region.Water.Oak Creek'].IsRoad)
//log(Turf.length(Turf.lineString(kml.Tree['North Region.Water.Oak Creek'].Coordinates()), {units: 'miles'}))

//let kml = new Kml('way/630174617.kml')
//log(kml.kml.Document[0])
//kml.Styles.Apply(new Kml(basePath+'Styles.kml'))
//_.logj(kml.kml.Document[0])
//kml.Styles.Clear()
//log(kml.kml.Document[0])

//log(kml.Export())

//kml = new Kml('315061563.kml')

//_.logj(kml)
//kml.Save('D:/GITHUB/Maps/kml/North1.kml')
